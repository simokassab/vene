<div class="mb-6">
  <div class="flex items-center justify-between">
    <h1 class="text-2xl font-bold text-gray-900">
      <%= t("admin.sub_categories.title", default: "Subcategories") %>
    </h1>
    <%= link_to new_admin_sub_category_path(locale: I18n.locale),
      class: "inline-flex items-center px-4 py-2 bg-[#465FFF] hover:bg-[#3651E6] text-white font-medium rounded-lg transition-colors" do %>
      <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
      </svg>
      <%= t("admin.sub_categories.new", default: "New Subcategory") %>
    <% end %>
  </div>
</div>

<!-- Search/Filter Form -->
<div class="bg-white rounded-xl border border-gray-200 shadow-sm p-4 mb-6">
  <%= search_form_for [:admin, @q], url: admin_sub_categories_path(locale: I18n.locale) do |f| %>
    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
      <div>
        <%= f.label :name_en_cont, "Name (English)", class: "block text-sm font-medium text-gray-700 mb-2" %>
        <%= f.search_field :name_en_cont, class: "w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#465FFF] focus:border-[#465FFF]", placeholder: "Search by name..." %>
      </div>
      <div>
        <%= f.label :category_id_eq, "Category", class: "block text-sm font-medium text-gray-700 mb-2" %>
        <%= f.collection_select :category_id_eq, Category.ordered, :id, :name_en,
          { include_blank: "All Categories" },
          class: "w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#465FFF] focus:border-[#465FFF]" %>
      </div>
      <div class="flex items-end">
        <%= f.submit "Search", class: "px-6 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors font-medium" %>
        <%= link_to "Reset", admin_sub_categories_path(locale: I18n.locale), class: "ml-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors" %>
      </div>
    </div>
  <% end %>
</div>

<!-- SubCategories Table -->
<div class="bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden">
  <% if @sub_categories.any? %>
    <table class="min-w-full divide-y divide-gray-200">
      <thead class="bg-gray-50">
        <tr>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Image</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Category</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Slug</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Position</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
        </tr>
      </thead>
      <tbody class="bg-white divide-y divide-gray-200">
        <% @sub_categories.each do |sub_category| %>
          <tr class="hover:bg-gray-50 transition-colors">
            <td class="px-6 py-4">
              <% if sub_category.image? %>
                <%= image_tag sub_category.image.thumb.url, class: "h-12 w-16 object-cover rounded" %>
              <% else %>
                <div class="h-12 w-16 bg-gradient-to-br from-[#465FFF] to-[#3651E6] rounded flex items-center justify-center">
                  <span class="text-lg font-bold text-white">
                    <%= sub_category.name_en.first(2).upcase %>
                  </span>
                </div>
              <% end %>
            </td>
            <td class="px-6 py-4">
              <div class="text-sm font-medium text-gray-900"><%= sub_category.name_en %></div>
              <div class="text-sm text-gray-500" dir="rtl"><%= sub_category.name_ar %></div>
            </td>
            <td class="px-6 py-4 text-sm text-gray-900">
              <%= sub_category.category.name_en %>
            </td>
            <td class="px-6 py-4 text-sm text-gray-500 font-mono"><%= sub_category.slug %></td>
            <td class="px-6 py-4 text-sm text-gray-900 text-center"><%= sub_category.position %></td>
            <td class="px-6 py-4">
              <% if sub_category.active? %>
                <span class="px-2 py-1 text-xs font-medium text-green-800 bg-green-100 rounded-full">Active</span>
              <% else %>
                <span class="px-2 py-1 text-xs font-medium text-gray-800 bg-gray-100 rounded-full">Inactive</span>
              <% end %>
            </td>
            <td class="px-6 py-4 text-sm font-medium space-x-3">
              <%= link_to edit_admin_sub_category_path(sub_category, locale: I18n.locale),
                class: "text-[#465FFF] hover:text-[#3651E6] transition-colors" do %>
                Edit
              <% end %>
              <%= link_to admin_sub_category_path(sub_category, locale: I18n.locale),
                data: { turbo_method: :delete, turbo_confirm: "Are you sure you want to delete this subcategory?" },
                class: "text-red-600 hover:text-red-800 transition-colors" do %>
                Delete
              <% end %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% else %>
    <div class="text-center py-12">
      <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"/>
      </svg>
      <h3 class="mt-2 text-sm font-medium text-gray-900">No subcategories found</h3>
      <p class="mt-1 text-sm text-gray-500">Get started by creating a new subcategory.</p>
      <div class="mt-6">
        <%= link_to new_admin_sub_category_path(locale: I18n.locale),
          class: "inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-[#465FFF] hover:bg-[#3651E6]" do %>
          <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
          </svg>
          New Subcategory
        <% end %>
      </div>
    </div>
  <% end %>
</div>

<!-- Pagination -->
<% if @pagy.pages > 1 %>
  <div class="mt-6">
    <%== pagy_nav(@pagy) %>
  </div>
<% end %>
