<%= form_with(model: [:admin, @coupon], local: true, class: "space-y-6") do |form| %>
  <% if @coupon.errors.any? %>
    <div class="rounded-lg border border-red-200 bg-red-50 p-4 text-sm text-red-800">
      <div class="font-semibold mb-2">Please fix the errors below</div>
      <ul class="list-disc pl-5 space-y-1">
        <% @coupon.errors.full_messages.each do |msg| %>
          <li><%= msg %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <!-- Basic Information Section -->
  <div class="bg-white rounded-xl border border-gray-200 shadow-sm p-6">
    <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
      <svg class="w-5 h-5 mr-2 text-[#465FFF]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"/>
      </svg>
      <%= t("admin.coupons.basic_info", default: "Coupon Details") %>
    </h3>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div>
        <%= form.label :code, t("admin.coupons.code", default: "Coupon Code"), class: "block text-sm font-medium text-gray-700 mb-2" %>
        <%= form.text_field :code,
          class: "block w-full px-4 py-2.5 text-sm text-gray-900 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#465FFF] focus:border-[#465FFF] transition-colors font-mono uppercase",
          placeholder: "SUMMER2025" %>
        <p class="mt-1 text-xs text-gray-500"><%= t("admin.coupons.code_hint", default: "Unique code (will be auto-uppercase)") %></p>
      </div>

      <div>
        <%= form.label :discount_type, t("admin.coupons.discount_type", default: "Discount Type"), class: "block text-sm font-medium text-gray-700 mb-2" %>
        <%= form.select :discount_type,
          options_for_select([
            [t("admin.coupons.percentage", default: "Percentage (%)"), "percentage"],
            [t("admin.coupons.fixed_amount", default: "Fixed Amount"), "fixed"]
          ], @coupon.discount_type),
          {},
          class: "block w-full px-4 py-2.5 text-sm text-gray-900 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#465FFF] focus:border-[#465FFF] transition-colors" %>
      </div>

      <div>
        <%= form.label :discount_value, t("admin.coupons.discount_value", default: "Discount Value"), class: "block text-sm font-medium text-gray-700 mb-2" %>
        <%= form.number_field :discount_value,
          step: 0.01,
          min: 0,
          class: "block w-full px-4 py-2.5 text-sm text-gray-900 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#465FFF] focus:border-[#465FFF] transition-colors",
          placeholder: "10.00" %>
        <p class="mt-1 text-xs text-gray-500"><%= t("admin.coupons.value_hint", default: "Percentage (0-100) or fixed amount") %></p>
      </div>

      <div>
        <%= form.label :min_order_amount, t("admin.coupons.min_order_amount", default: "Minimum Order Amount"), class: "block text-sm font-medium text-gray-700 mb-2" %>
        <%= form.number_field :min_order_amount,
          step: 0.01,
          min: 0,
          class: "block w-full px-4 py-2.5 text-sm text-gray-900 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#465FFF] focus:border-[#465FFF] transition-colors",
          placeholder: "0.00" %>
        <p class="mt-1 text-xs text-gray-500"><%= t("admin.coupons.min_amount_hint", default: "Optional: Minimum subtotal required") %></p>
      </div>
    </div>
  </div>

  <!-- Validity & Usage Section -->
  <div class="bg-white rounded-xl border border-gray-200 shadow-sm p-6">
    <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
      <svg class="w-5 h-5 mr-2 text-[#465FFF]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
      </svg>
      <%= t("admin.coupons.validity_usage", default: "Validity & Usage Limits") %>
    </h3>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div>
        <%= form.label :valid_from, t("admin.coupons.valid_from", default: "Valid From"), class: "block text-sm font-medium text-gray-700 mb-2" %>
        <%= form.date_field :valid_from,
          class: "block w-full px-4 py-2.5 text-sm text-gray-900 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#465FFF] focus:border-[#465FFF] transition-colors" %>
        <p class="mt-1 text-xs text-gray-500"><%= t("admin.coupons.valid_from_hint", default: "Optional: Start date") %></p>
      </div>

      <div>
        <%= form.label :valid_until, t("admin.coupons.valid_until", default: "Valid Until"), class: "block text-sm font-medium text-gray-700 mb-2" %>
        <%= form.date_field :valid_until,
          class: "block w-full px-4 py-2.5 text-sm text-gray-900 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#465FFF] focus:border-[#465FFF] transition-colors" %>
        <p class="mt-1 text-xs text-gray-500"><%= t("admin.coupons.valid_until_hint", default: "Optional: Expiry date") %></p>
      </div>

      <div>
        <%= form.label :usage_limit, t("admin.coupons.usage_limit", default: "Total Usage Limit"), class: "block text-sm font-medium text-gray-700 mb-2" %>
        <%= form.number_field :usage_limit,
          min: 0,
          class: "block w-full px-4 py-2.5 text-sm text-gray-900 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#465FFF] focus:border-[#465FFF] transition-colors",
          placeholder: "Unlimited" %>
        <p class="mt-1 text-xs text-gray-500"><%= t("admin.coupons.usage_limit_hint", default: "Optional: Max total uses (leave blank for unlimited)") %></p>
      </div>

      <div class="flex flex-col justify-center space-y-4">
        <div class="flex items-start">
          <div class="flex items-center h-5">
            <%= form.check_box :single_use_per_user,
              class: "w-4 h-4 text-[#465FFF] bg-gray-100 border-gray-300 rounded focus:ring-[#465FFF] focus:ring-2" %>
          </div>
          <div class="ml-3">
            <%= form.label :single_use_per_user, t("admin.coupons.single_use_per_user", default: "Single Use Per User"), class: "text-sm font-medium text-gray-700" %>
            <p class="text-xs text-gray-500"><%= t("admin.coupons.single_use_hint", default: "Each user can use this coupon only once") %></p>
          </div>
        </div>

        <div class="flex items-start">
          <div class="flex items-center h-5">
            <%= form.check_box :active,
              class: "w-4 h-4 text-[#465FFF] bg-gray-100 border-gray-300 rounded focus:ring-[#465FFF] focus:ring-2" %>
          </div>
          <div class="ml-3">
            <%= form.label :active, t("admin.coupons.active", default: "Active"), class: "text-sm font-medium text-gray-700" %>
            <p class="text-xs text-gray-500"><%= t("admin.coupons.active_hint", default: "Make this coupon available for use") %></p>
          </div>
        </div>
      </div>
    </div>

    <% if @coupon.persisted? %>
      <div class="mt-6 pt-6 border-t border-gray-200">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
          <div>
            <span class="font-medium text-gray-700"><%= t("admin.coupons.current_usage", default: "Current Usage:") %></span>
            <span class="text-gray-900"><%= @coupon.usage_count %></span>
          </div>
          <div>
            <span class="font-medium text-gray-700"><%= t("admin.coupons.orders_count", default: "Orders:") %></span>
            <span class="text-gray-900"><%= @coupon.orders.count %></span>
          </div>
        </div>
      </div>
    <% end %>
  </div>

  <!-- Form Actions -->
  <div class="flex items-center justify-between pt-4">
    <%= link_to admin_coupons_path(locale: I18n.locale),
      class: "inline-flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors" do %>
      <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
      </svg>
      <%= t("common.cancel", default: "Cancel") %>
    <% end %>

    <%= form.submit t("admin.actions.save"),
      class: "inline-flex items-center px-6 py-2.5 bg-[#465FFF] hover:bg-[#3651E6] text-white font-medium rounded-lg shadow-sm transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#465FFF]" %>
  </div>
<% end %>
